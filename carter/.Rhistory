"proximity",
"2009",
"housing"),
ignore.case = TRUE),
-`State/Territory`,
-`Percent age 10 to 64`,
-`Energy burden`,
-`Percent pre-1960s housing (lead paint indicator)`,
-`Wastewater discharge`,
-`Leaky underground storage tanks`,
-`Diesel particulate matter exposure`,
-`Share of homes with no kitchen or indoor plumbing (percent)`,
-`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
-`Median household income as a percent of area median income`,
-`Percent of residents who are not currently enrolled in higher ed`,
-`Percent two or more races`,
-`Percent other races`)
metric_names <-
selected_data |>
as.data.frame() |>
select(where(is.numeric)) |>
names()
metric_names
selected_data <-
oregon_data |>
select(-where(is.logical),
-contains(c("percentile",
"exceeded",
"disadvantaged",
"area",
"adjusted",
"proximity",
"2009",
"housing"),
ignore.case = TRUE),
-`State/Territory`,
-`Percent age 10 to 64`,
-`Energy burden`,
-`Percent pre-1960s housing (lead paint indicator)`,
-`Wastewater discharge`,
-`Leaky underground storage tanks`,
-`Share of homes with no kitchen or indoor plumbing (percent)`,
-`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
-`Median household income as a percent of area median income`,
-`Percent of residents who are not currently enrolled in higher ed`,
-`Percent two or more races`,
-`Percent other races`,
-`Life expectancy (years)`,
-`Linguistic isolation (percent)`)
metric_names <-
selected_data |>
as.data.frame() |>
select(where(is.numeric)) |>
names()
metric_names
selected_data <-
oregon_data |>
select(-where(is.logical),
-contains(c("percentile",
"exceeded",
"disadvantaged",
"area",
"adjusted",
"proximity",
"2009",
"housing"),
ignore.case = TRUE),
-`State/Territory`,
-`Percent age 10 to 64`,
-`Energy burden`,
-`Percent pre-1960s housing (lead paint indicator)`,
-`Wastewater discharge`,
-`Leaky underground storage tanks`,
-`Share of homes with no kitchen or indoor plumbing (percent)`,
-`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
-`Median household income as a percent of area median income`,
-`Percent of residents who are not currently enrolled in higher ed`,
-`Percent two or more races`,
-`Percent other races`,
-`Life expectancy (years)`)
metric_names <-
selected_data |>
as.data.frame() |>
select(where(is.numeric)) |>
names()
metric_names
View(federal_data)
View(federal_data)
metric_names
federal_data <- read_csv("../data/climate_env_justice_screening_tool.csv")
oregon_data <- federal_data |>
filter(`State/Territory` == "Oregon")
selected_data <-
oregon_data |>
select(-where(is.logical),
-contains(c("percentile",
"exceeded",
"disadvantaged",
"area",
"adjusted",
"proximity",
"2009",
"housing"),
ignore.case = TRUE),
-`State/Territory`,
-`Percent age 10 to 64`,
-`Energy burden`,
-`Percent pre-1960s housing (lead paint indicator)`,
-`Wastewater discharge`,
-`Leaky underground storage tanks`,
-`Share of homes with no kitchen or indoor plumbing (percent)`,
-`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
-`Median household income as a percent of area median income`,
-`Percent of residents who are not currently enrolled in higher ed`,
-`Percent two or more races`,
-`Percent other races`,
-`Life expectancy (years)`)
# metric_names <-
#   selected_data |>
#   as.data.frame() |>
#   select(where(is.numeric)) |>
#   names()
sens_options <-
selected_data |>
as.data.frame() |>
select(`Percent age under 10`,
`Percent age over 64`,
`Current asthma among adults aged greater than or equal to 18 years`) |>
names()
expo_options <-
selected_data |>
as.data.frame() |>
select(`Expected agricultural loss rate (Natural Hazards Risk Index)`:`Diesel particulate matter exposure`) |>
names()
demo_options <-
selected_data |>
as.data.frame() |>
select(`Percent Black or African American alone`:`Percent Hispanic or Latino`) |>
names()
grouped_data <-
selected_data |>
group_by(`County Name`)
counties_sf <- counties(state = "OR", year = 2010)
library(tigris)
federal_data <- read_csv("../data/climate_env_justice_screening_tool.csv")
oregon_data <- federal_data |>
filter(`State/Territory` == "Oregon")
selected_data <-
oregon_data |>
select(-where(is.logical),
-contains(c("percentile",
"exceeded",
"disadvantaged",
"area",
"adjusted",
"proximity",
"2009",
"housing"),
ignore.case = TRUE),
-`State/Territory`,
-`Percent age 10 to 64`,
-`Energy burden`,
-`Percent pre-1960s housing (lead paint indicator)`,
-`Wastewater discharge`,
-`Leaky underground storage tanks`,
-`Share of homes with no kitchen or indoor plumbing (percent)`,
-`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
-`Median household income as a percent of area median income`,
-`Percent of residents who are not currently enrolled in higher ed`,
-`Percent two or more races`,
-`Percent other races`,
-`Life expectancy (years)`)
# metric_names <-
#   selected_data |>
#   as.data.frame() |>
#   select(where(is.numeric)) |>
#   names()
sens_options <-
selected_data |>
as.data.frame() |>
select(`Percent age under 10`,
`Percent age over 64`,
`Current asthma among adults aged greater than or equal to 18 years`) |>
names()
expo_options <-
selected_data |>
as.data.frame() |>
select(`Expected agricultural loss rate (Natural Hazards Risk Index)`:`Diesel particulate matter exposure`) |>
names()
demo_options <-
selected_data |>
as.data.frame() |>
select(`Percent Black or African American alone`:`Percent Hispanic or Latino`) |>
names()
grouped_data <-
selected_data |>
group_by(`County Name`)
counties_sf <- counties(state = "OR", year = 2010)
rm(federal_data)
rm(oregon_data)
rm(selected_data)
save.image(file = "shiny_data.RData")
library(flexdashboard)
library(ggplot2)
library(dplyr)
library(stringr)
library(sf)
library(biscale)
library(cowplot)
library(ggiraph)
library(patchwork)
# library(tigris)
# Comments below are how to get from the CSV to the dataset needed for this proof-of-concept
# Only counties_sf, grouped_data, and metric_names are needed. The rest were removed before saving the .RData file.
#
# federal_data <- read_csv("../data/climate_env_justice_screening_tool.csv")
#
# oregon_data <- federal_data |>
#   filter(`State/Territory` == "Oregon")
#
# selected_data <-
#   oregon_data |>
#   select(-where(is.logical),
#          -contains(c("percentile",
#                      "exceeded",
#                      "disadvantaged",
#                      "area",
#                      "adjusted",
#                      "proximity",
#                      "2009",
#                      "housing"),
#                    ignore.case = TRUE),
#          -`State/Territory`,
#          -`Percent age 10 to 64`,
#          -`Energy burden`,
#          -`Percent pre-1960s housing (lead paint indicator)`,
#          -`Wastewater discharge`,
#          -`Leaky underground storage tanks`,
#          -`Share of homes with no kitchen or indoor plumbing (percent)`,
#          -`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
#          -`Median household income as a percent of area median income`,
#          -`Percent of residents who are not currently enrolled in higher ed`,
#          -`Percent two or more races`,
#          -`Percent other races`,
#          -`Life expectancy (years)`)
#
# metric_names <-
#   selected_data |>
#   as.data.frame() |>
#   select(where(is.numeric)) |>
#   names()
#
# sens_options <-
#   selected_data |>
#   as.data.frame() |>
#   select(`Percent age under 10`,
#          `Percent age over 64`,
#          `Current asthma among adults aged greater than or equal to 18 years`) |>
#   names()
#
# expo_options <-
#   selected_data |>
#   as.data.frame() |>
#   select(`Expected agricultural loss rate (Natural Hazards Risk Index)`:`Diesel particulate matter exposure`) |>
#   names()
#
# demo_options <-
#   selected_data |>
#   as.data.frame() |>
#   select(`Percent Black or African American alone`:`Percent Hispanic or Latino`) |>
#   names()
#
# grouped_data <-
#   selected_data |>
#   group_by(`County Name`)
#
# counties_sf <- counties(state = "OR", year = 2010)
#
# rm(federal_data)
# rm(oregon_data)
# rm(selected_data)
#
# save.image(file = "shiny_data.RData")
load("../data/shiny_data.RData")
layout <- "
#######################
##BBBB#################
##BBBB##AAAAAAAAAAAAAAA
##BBBB##AAAAAAAAAAAAAAA
##BBBB##AAAAAAAAAAAAAAA
CCCCCCCCAAAAAAAAAAAAAAA
CCCCCCCCAAAAAAAAAAAAAAA
CCCCCCCCAAAAAAAAAAAAAAA
CCCCCCCCAAAAAAAAAAAAAAA
CCCCCCCCAAAAAAAAAAAAAAA
CCCCCCCCAAAAAAAAAAAAAAA
CCCCCCCC###############
#######################
"
load("../data/shiny_data.RData")
library(tigris)
library(readr)
federal_data <- read_csv("../data/climate_env_justice_screening_tool.csv")
oregon_data <- federal_data |>
filter(`State/Territory` == "Oregon")
selected_data <-
oregon_data |>
select(-where(is.logical),
-contains(c("percentile",
"exceeded",
"disadvantaged",
"area",
"adjusted",
"proximity",
"2009",
"housing"),
ignore.case = TRUE),
-`State/Territory`,
-`Percent age 10 to 64`,
-`Energy burden`,
-`Percent pre-1960s housing (lead paint indicator)`,
-`Wastewater discharge`,
-`Leaky underground storage tanks`,
-`Share of homes with no kitchen or indoor plumbing (percent)`,
-`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
-`Median household income as a percent of area median income`,
-`Percent of residents who are not currently enrolled in higher ed`,
-`Percent two or more races`,
-`Percent other races`,
-`Life expectancy (years)`)
metric_names <-
selected_data |>
as.data.frame() |>
select(where(is.numeric)) |>
names()
sens_options <-
selected_data |>
as.data.frame() |>
select(`Percent age under 10`,
`Percent age over 64`,
`Current asthma among adults aged greater than or equal to 18 years`) |>
names()
expo_options <-
selected_data |>
as.data.frame() |>
select(`Expected agricultural loss rate (Natural Hazards Risk Index)`:`Diesel particulate matter exposure`) |>
names()
demo_options <-
selected_data |>
as.data.frame() |>
select(`Percent Black or African American alone`:`Percent Hispanic or Latino`) |>
names()
grouped_data <-
selected_data |>
group_by(`County Name`)
counties_sf <- counties(state = "OR", year = 2010)
rm(federal_data)
rm(oregon_data)
rm(selected_data)
save.image(file = "../data/shiny_data.RData")
rm(metric_names)
save.image(file = "../data/shiny_data.RData")
load("../data/shiny_data.RData")
load("../data/shiny_data.RData")
View(grouped_data)
weighted.mean(c(0.2,0.7,0.4), c(9,4,3))
library(readr)
library(tigris)
federal_data <- read_csv("../data/climate_env_justice_screening_tool.csv")
oregon_data <- federal_data |>
filter(`State/Territory` == "Oregon")
selected_data <-
oregon_data |>
select(-where(is.logical),
-contains(c("percentile",
"exceeded",
"disadvantaged",
"area",
"adjusted",
"proximity",
"2009",
"housing"),
ignore.case = TRUE),
-`State/Territory`,
-`Percent age 10 to 64`,
-`Energy burden`,
-`Percent pre-1960s housing (lead paint indicator)`,
-`Wastewater discharge`,
-`Leaky underground storage tanks`,
-`Share of homes with no kitchen or indoor plumbing (percent)`,
-`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
-`Median household income as a percent of area median income`,
-`Percent of residents who are not currently enrolled in higher ed`,
-`Percent two or more races`,
-`Percent other races`,
-`Life expectancy (years)`)
metric_names <-
selected_data |>
as.data.frame() |>
select(where(is.numeric)) |>
names()
metaNameUndo()
metric_names
library(readr)
library(tigris)
federal_data <- read_csv("../data/climate_env_justice_screening_tool.csv")
oregon_data <- federal_data |>
filter(`State/Territory` == "Oregon")
selected_data <-
oregon_data |>
select(-where(is.logical),
-contains(c("percentile",
"exceeded",
"disadvantaged",
"area",
"adjusted",
"proximity",
"2009",
"housing"),
ignore.case = TRUE),
-`State/Territory`,
-`Percent age 10 to 64`,
-`Energy burden`,
-`Percent pre-1960s housing (lead paint indicator)`,
-`Wastewater discharge`,
-`Leaky underground storage tanks`,
-`Share of homes with no kitchen or indoor plumbing (percent)`,
-`Diagnosed diabetes among adults aged greater than or equal to 18 years`,
-`Median household income as a percent of area median income`,
-`Percent of residents who are not currently enrolled in higher ed`,
-`Percent two or more races`,
-`Percent other races`,
-`Life expectancy (years)`)
# metric_names <-
#   selected_data |>
#   as.data.frame() |>
#   select(where(is.numeric)) |>
#   names()
sens_options <-
selected_data |>
as.data.frame() |>
select(`Percent age under 10`,
`Percent age over 64`,
`Current asthma among adults aged greater than or equal to 18 years`:`Percent individuals age 25 or over with less than high school degree`) |>
names()
expo_options <-
selected_data |>
as.data.frame() |>
select(`Expected agricultural loss rate (Natural Hazards Risk Index)`:`Diesel particulate matter exposure`) |>
names()
demo_options <-
selected_data |>
as.data.frame() |>
select(`Percent Black or African American alone`:`Percent Hispanic or Latino`) |>
names()
grouped_data <-
selected_data |>
group_by(`County Name`)
counties_sf <- counties(state = "OR", year = 2010)
rm(federal_data)
rm(oregon_data)
rm(selected_data)
save.image(file = "../data/shiny_data.RData")
counties_summary <-
grouped_data |>
summarize(sens = weighted.mean(.data[['Current asthma among adults aged greater than or equal to 18 years']], `Total population`, na.rm = T),
expo = weighted.mean(.data[['PM2.5 in the air']], `Total population`, na.rm = T),
demo = weighted.mean(.data[['Percent Black or African American']], `Total population`, na.rm = T)) |>
mutate(scl1 = (sens - min(.data[["sens"]])) / (max(.data[["sens"]]) - min(.data[["sens"]])),
scl2 = (expo - min(.data[["expo"]])) / (max(.data[["expo"]]) - min(.data[["expo"]])),
vuln = (scl1 + scl2) / 2) |>
left_join(counties_sf, by = c("County Name" = "NAMELSAD10")) |>
st_as_sf()
counties_summary <-
grouped_data |>
summarize(sens = weighted.mean(Current asthma among adults aged greater than or equal to 18 years, `Total population`, na.rm = T),
counties_summary <-
grouped_data |>
summarize(sens = weighted.mean(`Current asthma among adults aged greater than or equal to 18 years`, `Total population`, na.rm = T),
expo = weighted.mean(`PM2.5 in the air`, `Total population`, na.rm = T),
demo = weighted.mean(`Percent Black or African American`, `Total population`, na.rm = T)) |>
mutate(scl1 = (sens - min(.data[["sens"]])) / (max(.data[["sens"]]) - min(.data[["sens"]])),
scl2 = (expo - min(.data[["expo"]])) / (max(.data[["expo"]]) - min(.data[["expo"]])),
vuln = (scl1 + scl2) / 2) |>
left_join(counties_sf, by = c("County Name" = "NAMELSAD10")) |>
st_as_sf()
View(grouped_data)
counties_summary <-
grouped_data |>
summarize(sens = weighted.mean(`Current asthma among adults aged greater than or equal to 18 years`, `Total population`, na.rm = T),
expo = weighted.mean(`PM2.5 in the air`, `Total population`, na.rm = T),
demo = weighted.mean(`Percent Black or African American alone`, `Total population`, na.rm = T)) |>
mutate(scl1 = (sens - min(.data[["sens"]])) / (max(.data[["sens"]]) - min(.data[["sens"]])),
scl2 = (expo - min(.data[["expo"]])) / (max(.data[["expo"]]) - min(.data[["expo"]])),
vuln = (scl1 + scl2) / 2) |>
left_join(counties_sf, by = c("County Name" = "NAMELSAD10")) |>
st_as_sf()
View(counties_summary)
counties_summary <-
grouped_data |>
summarize(sens = weighted.mean(`Current asthma among adults aged greater than or equal to 18 years`, `Total population`, na.rm = T),
expo = weighted.mean(`PM2.5 in the air`, `Total population`, na.rm = T),
demo = weighted.mean(`Percent Black or African American alone`, `Total population`, na.rm = T)) |>
mutate(scl1 = (sens - min(.data[["sens"]])) / (max(.data[["sens"]]) - min(.data[["sens"]])),
scl2 = (expo - min(.data[["expo"]])) / (max(.data[["expo"]]) - min(.data[["expo"]])),
vuln = (scl1 + scl2) / 2)
ecdf(counties_summary$sens)(counties_summary$sens)
View(grouped_data)
View(grouped_data)
install.packages("shinythemes")
install.packages("shinyWidgets")
setwd("~/Documents/capstone/repo/carter")
